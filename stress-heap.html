<html>
<script>

function log(message) {
  document.getElementById("log").textContent = message;
}

var nodes;
var count;
var current;

function generate() {
  const kChunkSize = 1000;
  const kMaxEdge = 1000;
  const kLogSize = 1000;
  for (var i = 0; i < kChunkSize && current < count; i++) {
    var node = {id: current, links: []};
    var edges = Math.min(kMaxEdge, i);
    for (var j = 0; j < edges; j++) {
      var neighbor = current - j - 1;
      node.links.push(nodes[neighbor]);
      nodes[neighbor].links.push(node);
    }
    nodes.push(node);
    current++;
    if (current % kLogSize === 0) {
      log("Created " + current + " objects...");
    }
  }
  if (current == count) {
    log("Created " + current + " objects. Done.");
  } else {
    setTimeout(generate, 0);
  }
}

function start() {
  nodes = [];
  count = document.getElementById("count").value;
  current = 0;

  setTimeout(generate, 0)
}

</script>
<body>
  <label for="count">Number of objects: </label>
  <input type="text" id="count" />
  <input type="button" value="Generate" onclick="start()">
  <div id="log"/>
</body>
</html>